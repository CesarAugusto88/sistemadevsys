
{% extends 'base-cliente.html' %}

{% block content %}
<div class="content-ribbon">
  {% block content_header %}
    <h2>Chamados</h2>
    <form action=""  class="form-inline" style="margin-bottom: 2%;">
      <div class="form-group">
        <label for="pesquisa" class="sr-only">Pesquisar</label>
        <input type="text" size="40" id="pesquisa" name="pesquisa" placeholder="Assunto" class="form-control">
      </div>
      <button type="submit" class="btn btn-primary" style="margin-left: 1%;">Pesquisar</button>
    </form>

    <a class="navbar-brand pure-button pure-button-primary btn-sm" 
    href="{% url 'cliente'  %}">
        <span class="icono-caretLeftSquare" aria-hidden="true"></span>
        Voltar
    </a>   
    <a class="navbar-brand pure-button pure-button-primary btn-sm" 
    href="{% url 'criar_chamado' %}">
        <span class="icono-plus" aria-hidden="true"></span>
        Novo Chamado
    </a>   
    
  {% endblock %}
  <div class="pure-u-1">
    <table class="pure-table pure-table-bordered">
      <thead>
        <tr>
          <th>Nome do Cliente</th>
          <th>Assunto</th>
          <th>Descrição</th>
          <th>Download</th>
          <th>Update</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        {% for chamado in chamados %}
          <tr>
            <td>{{ chamado.nome_cliente }}</td>
            <td>{{ chamado.assunto }}</td>
            <td>{{ chamado.descricao }}</td>
            <td>
              {% if chamado.arquivo %}
              <a href="{{ chamado.arquivo.url }}" class="pure-button pure-button-active" target="_blank">
                Download
              </a>
              {% else %}
                <span class="pure-form-message">No arquivo</span>
              {% endif %}
            </td>
            <td>
              <a href="{% url 'update_chamado' chamado.id %}" style="text-decoration:none">
                <button class="btn btn-info btn-sm" type="button">
                  Update
                </button>
              </a>
            </td>
            <!-- exclusão por cliente...-->
            <td>
              <form method="post" action="{% url 'delete_chamado' chamado.id %}"> <!--Deve ser 'pk' em urls também-->
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Tem certeza que deseja deletar esse registro?');">
                  Delete
                </button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}